# Nemotron 3 Nano â€” Code Vulnerability Detection & Repair
# 4x H100: 2 inference (TP=2) + 2 training (FSDP2 + LoRA)

inference_gpu_ids = [0, 1]
trainer_gpu_ids = [2, 3]

max_steps = 200
seq_len = 4096
output_dir = "/root/checkpoints/nemotron-code-vulnerability"

[model]
name = "nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-BF16"

[wandb]
project = "re-zero"
name = "nemotron-code-vulnerability"
offline = true

[ckpt]

[trainer.model]
impl = "auto"
attn = "eager"
trust_remote_code = true

[trainer.model.ac]
freq = 1

[trainer.model.lora]
rank = 32
alpha = 64
target_modules = ["q_proj", "k_proj", "v_proj", "o_proj"]

[trainer.optim]
lr = 1e-5

[orchestrator]
batch_size = 128
rollouts_per_example = 8

[orchestrator.sampling]
max_tokens = 1024

[[orchestrator.env]]
id = "intertwine/sv-env-code-vulnerability"
name = "code-vulnerability"

[inference]

[inference.model]
trust_remote_code = true

[inference.parallel]
dp = 1
